<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Alex, HTML,CSS,JavaScript,JQuery,React,Vue.js java c++ 算法等">
    <meta name="description" content="专注于学习知识,分享生活,分享知识">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Alex | flyboy&#39;blog</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style><link rel="alternate" href="/atom.xml" title="flyboy'blog" type="application/atom+xml">
<link rel="alternate" href="/rss2.xml" title="flyboy'blog" type="application/rss+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


    
        <style>
    body{
       background-image: url(https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/site/medias/background.jpg);
       background-repeat:no-repeat;
       background-size:cover;
       background-attachment:fixed;
    }
</style>

            

                <head>
                    <meta charset="utf-8">
                    <meta http-equiv="X-UA-Compatible" content="IE=edge">
                    <meta name="viewport" content="width=device-width,initial-scale=1">
                    <meta name="author" content="itsneko">
                    <meta name="keywords" content="itsneko">
                    <meta name="description" content="元宵节灯笼样式">
                <style type="text/css" lang="css">
    #loading-container{
        position: fixed;
        top: 0;
        left: 0;
        min-height: 100vh;
        width: 100vw;
        z-index: 9999;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background: #FFF;
        text-align: center;
        /* loader页面消失采用渐隐的方式*/
        -webkit-transition: opacity 1s ease;
        -moz-transition: opacity 1s ease;
        -o-transition: opacity 1s ease;
        transition: opacity 1s ease;
    }
    .loading-image{
        width: 120px;
        height: 50px;
        transform: translate(-50%);
    }
    
    .loading-image div:nth-child(2) {
        -webkit-animation: pacman-balls 1s linear 0s infinite;
        animation: pacman-balls 1s linear 0s infinite
    }

    .loading-image div:nth-child(3) {
        -webkit-animation: pacman-balls 1s linear .33s infinite;
        animation: pacman-balls 1s linear .33s infinite
    }

    .loading-image div:nth-child(4) {
        -webkit-animation: pacman-balls 1s linear .66s infinite;
        animation: pacman-balls 1s linear .66s infinite
    }

    .loading-image div:nth-child(5) {
        -webkit-animation: pacman-balls 1s linear .99s infinite;
        animation: pacman-balls 1s linear .99s infinite
    }
    
   .loading-image div:first-of-type {
        width: 0;
        height: 0;
        border: 25px solid #49b1f5;
        border-right-color: transparent;
        border-radius: 25px;
        -webkit-animation: rotate_pacman_half_up .5s 0s infinite;
        animation: rotate_pacman_half_up .5s 0s infinite;
    }
    .loading-image div:nth-child(2) {
        width: 0;
        height: 0;
        border: 25px solid #49b1f5;
        border-right-color: transparent;
        border-radius: 25px;
        -webkit-animation: rotate_pacman_half_down .5s 0s infinite;
        animation: rotate_pacman_half_down .5s 0s infinite;
        margin-top: -50px;
    }
    @-webkit-keyframes rotate_pacman_half_up {0% {transform: rotate(270deg)}50% {transform: rotate(1turn)}to {transform: rotate(270deg)}}

    @keyframes rotate_pacman_half_up {0% {transform: rotate(270deg)}50% {transform: rotate(1turn)}to {transform: rotate(270deg)}}

    @-webkit-keyframes rotate_pacman_half_down {0% {transform: rotate(90deg)}50% {transform: rotate(0deg)}to {transform: rotate(90deg)}}

    @keyframes rotate_pacman_half_down {0% {transform: rotate(90deg)}50% {transform: rotate(0deg)}to {transform: rotate(90deg)}}
    
    @-webkit-keyframes pacman-balls {75% {opacity: .7}to {transform: translate(-100px, -6.25px)}}

    @keyframes pacman-balls {75% {opacity: .7}to {transform: translate(-100px, -6.25px)}}
    
   
    .loading-image div:nth-child(3),
    .loading-image div:nth-child(4),
    .loading-image div:nth-child(5),
    .loading-image div:nth-child(6){
        background-color: #49b1f5;
        width: 15px;
        height: 15px;
        border-radius: 100%;
        margin: 2px;
        width: 10px;
        height: 10px;
        position: absolute;
        transform: translateY(-6.25px);
        top: 25px;
        left: 100px;
    }
    .loading-text{
        margin-bottom: 20vh;
        text-align: center;
        color: #2c3e50;
        font-size: 2rem;
        box-sizing: border-box;
        padding: 0 10px;
        text-shadow: 0 2px 10px rgba(0,0,0,0.2);
    }
    @media only screen and (max-width: 500px) {
         .loading-text{
            font-size: 1.5rem;
         }
    }
    .fadeout {
        opacity: 0;
        filter: alpha(opacity=0);
    }
    /* logo出现动画 */
    @-webkit-keyframes fadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0)}100%{opacity:1;-webkit-transform:none;transform:none}}
    @keyframes fadeInDown{0%{opacity:0;-webkit-transform:translate3d(0,-100%,0);}}
 </style>
 <script>
(function () {
    const loaded = function(){
       setTimeout(function(){
            const loader = document.getElementById("loading-container");
            loader.className="fadeout" ;//使用渐隐的方法淡出loading page
            // document.getElementById("body-wrap").style.display="flex";
            setTimeout(function(){
                loader.style.display="none";
            },1000); 
        },1000);//强制显示loading page 1s  
    };
    loaded();
})()
 </script></head>

                
 <div id="loading-container">
     <p class="loading-text">玩命加载中 . . . </p> 
     <div class="loading-image">
         <div></div>
         <div></div>
         <div></div>
         <div></div> 
         <div></div>
     </div>
 </div><body>

                    <!-- 元宵节灯笼样式开始 -->
                    <style>
                        @media only screen and (min-width: 1124px) {
                            .nav-menu {
                                padding-right: 96px;
                            }
                        }

                        @media only screen and (max-width: 760px) {

                            .deng-box,
                            .deng-box1 {
                                width: 40%;
                            }

                            .right {
                                float: left !important;
                            }
                        }

                        @media only screen and (min-width: 768px) and (max-width: 1024px) {
                            .right {
                                float: left !important;
                            }
                        }

                        .deng-box {
                            position: fixed;
                            top: -40px;
                            right: -20px;
                            z-index: 20;
                        }

                        .deng-box1 {
                            position: fixed;
                            top: -30px;
                            right: 10px;
                            z-index: 20;
                        }

                        .deng-box1 .deng {
                            position: relative;
                            width: 120px;
                            height: 90px;
                            margin: 50px;
                            background: #d8000f;
                            background: rgba(216, 0, 15, 0.8);
                            border-radius: 50% 50%;
                            -webkit-transform-origin: 50% -100px;
                            -webkit-animation: swing 5s infinite ease-in-out;
                            box-shadow: -5px 5px 30px 4px rgba(252, 144, 61, 1);
                        }

                        .deng {
                            position: relative;
                            width: 120px;
                            height: 90px;
                            margin: 50px;
                            background: #d8000f;
                            background: rgba(216, 0, 15, 0.8);
                            border-radius: 50% 50%;
                            -webkit-transform-origin: 50% -100px;
                            -webkit-animation: swing 3s infinite ease-in-out;
                            box-shadow: -5px 5px 50px 4px rgba(250, 108, 0, 1);
                        }

                        .deng-a {
                            width: 100px;
                            height: 90px;
                            background: #d8000f;
                            background: rgba(216, 0, 15, 0.1);
                            margin: 12px 8px 8px 10px;
                            border-radius: 50% 50%;
                            border: 2px solid #dc8f03;
                        }

                        .deng-b {
                            width: 45px;
                            height: 90px;
                            background: #d8000f;
                            background: rgba(216, 0, 15, 0.1);
                            margin: -4px 8px 8px 26px;
                            border-radius: 50% 50%;
                            border: 2px solid #dc8f03;
                        }

                        .xian {
                            position: absolute;
                            top: -20px;
                            left: 60px;
                            width: 2px;
                            height: 20px;
                            background: #dc8f03;
                        }

                        .shui-a {
                            position: relative;
                            width: 5px;
                            height: 20px;
                            margin: -5px 0 0 59px;
                            -webkit-animation: swing 4s infinite ease-in-out;
                            -webkit-transform-origin: 50% -45px;
                            background: #ffa500;
                            border-radius: 0 0 5px 5px;
                        }

                        .shui-b {
                            position: absolute;
                            top: 14px;
                            left: -2px;
                            width: 10px;
                            height: 10px;
                            background: #dc8f03;
                            border-radius: 50%;
                        }

                        .shui-c {
                            position: absolute;
                            top: 18px;
                            left: -2px;
                            width: 10px;
                            height: 35px;
                            background: #ffa500;
                            border-radius: 0 0 0 5px;
                        }

                        .deng:before {
                            position: absolute;
                            top: -7px;
                            left: 29px;
                            height: 12px;
                            width: 60px;
                            content: " ";
                            display: block;
                            z-index: 20;
                            border-radius: 5px 5px 0 0;
                            border: solid 1px #dc8f03;
                            background: #ffa500;
                            background: linear-gradient(to right, #dc8f03, #ffa500, #dc8f03, #ffa500, #dc8f03);
                        }

                        .deng:after {
                            position: absolute;
                            bottom: -7px;
                            left: 10px;
                            height: 12px;
                            width: 60px;
                            content: " ";
                            display: block;
                            margin-left: 20px;
                            border-radius: 0 0 5px 5px;
                            border: solid 1px #dc8f03;
                            background: #ffa500;
                            background: linear-gradient(to right, #dc8f03, #ffa500, #dc8f03, #ffa500, #dc8f03);
                        }

                        @font-face {
                            font-family: "华文行楷";
                            src: url('/fonts/华文行楷.ttf');
                        }

                        .deng-t {
                            font-family: 华文行楷;
                            font-size: 26px;
                            color: #dc8f03;
                            font-weight: bold;
                            line-height: 44px;
                            text-align: center;
                        }

                        .night .deng-t,
                        .night .deng-box,
                        .night .deng-box1 {
                            background: transparent !important;
                        }

                        @-moz-keyframes swing {
                            0% {
                                -moz-transform: rotate(-10deg)
                            }

                            50% {
                                -moz-transform: rotate(10deg)
                            }

                            100% {
                                -moz-transform: rotate(-10deg)
                            }
                        }

                        @-webkit-keyframes swing {
                            0% {
                                -webkit-transform: rotate(-10deg)
                            }

                            50% {
                                -webkit-transform: rotate(10deg)
                            }

                            100% {
                                -webkit-transform: rotate(-10deg)
                            }
                        }
                    </style>
                    <div class="deng-box">
                        <div class="deng">
                            <div class="xian"></div>
                            <div class="deng-a">
                                <div class="deng-b">
                                    <div class="deng-t">喜迎</div>
                                </div>
                            </div>
                            <div class="shui shui-a">
                                <div class="shui-c"></div>
                                <div class="shui-b"></div>
                            </div>
                        </div>
                    </div>
                    <div class="deng-box1">
                        <div class="deng">
                            <div class="xian"></div>
                            <div class="deng-a">
                                <div class="deng-b">
                                    <div class="deng-t">元旦</div>
                                </div>
                            </div>
                            <div class="shui shui-a">
                                <div class="shui-c"></div>
                                <div class="shui-b"></div>
                            </div>
                        </div>
                    </div>
                    <!-- 元宵节灯笼样式结束 -->
                    <script> if (localStorage.getItem('dark') === '1') { document.body.classList.add('dark'); } else if (new Date().getHours() >= 22 || new Date().getHours() < 7) { document.body.classList.add('dark'); } else if (matchMedia('(prefers-color-scheme: dark)').matches) { document.body.classList.add('dark'); } </script>
                    <a onclick="switchNightMode()" id="sma"> <i class="fa fa-moon-o" id="nightMode"
                            aria-hidden="true"></i> </a>
                    <style>
                        /* 深色模式按钮设置 */
                        #sma {
                            background: #000;
                            width: 38px;
                            height: 38px;
                            display: block;
                            position: fixed;
                            border-radius: 50%;
                            right: 15px;
                            bottom: 170px;
                            padding-top: 15px;
                            margin-bottom: 0;
                            z-index: 90;
                            cursor: pointer;
                        }

                        #sma .fa-moon-o {
                            position: absolute;
                            right: 8px;
                            bottom: 8px;
                            font-size: 1.48rem !important;
                        }

                        #sma .fa-lightbulb-o {
                            position: absolute;
                            right: 13px;
                            bottom: 8px;
                            font-size: 1.5rem !important;
                        }

                        .fa-moon-o:before {
                            content: "\f186";
                        }

                        .fa-comments:before {
                            content: "\f086";
                        }
                    </style>

                    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    <div>
                        
                            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/medias/logo.png" class="logo-img" alt="LOGO">
                            
                                <span class="logo-span">
                                    flyboy'blog
                                </span>
                    </div>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/navigate" class="waves-effect waves-light">
      
      <i class="fas fa-location-arrow" style="zoom: 0.6;"></i>
      
      <span>导航</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/archives">
          
          <i class="fas fa-sitemap" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>归档</span>
        </a>
      </li>
      
      <li>
        <a href="/tags">
          
          <i class="fas fa-tags" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>标签</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fas fa-list" style="zoom: 0.6;"></i>
      
      <span>娱乐</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/musics">
          
          <i class="fas fa-music" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>音乐</span>
        </a>
      </li>
      
      <li>
        <a href="/video">
          
          <i class="fas fa-film" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>电影</span>
        </a>
      </li>
      
      <li>
        <a href="/books">
          
          <i class="fas fa-book" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>书城</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fas fa-address-card" style="zoom: 0.6;"></i>
      
      <span>关于</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/about">
          
          <i class="fas fa-user-circle" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>关于我</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/aboutme" class="waves-effect waves-light">
      
      <i class="fa fa-user-secret" style="zoom: 0.6;"></i>
      
      <span>聚宝盒</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">flyboy&#39;blog</div>
        <div class="logo-desc">
            
            专注于学习知识,分享生活,分享知识
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/navigate" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-location-arrow"></i>
			
			导航
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-archive"></i>
			
			归档
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/archives " style="margin-left:75px">
				  
				   <i class="fa fas fa-sitemap" style="position: absolute;left:50px" ></i>
			      
		          <span>归档</span>
                  </a>
                </li>
              
                <li>

                  <a href="/tags " style="margin-left:75px">
				  
				   <i class="fa fas fa-tags" style="position: absolute;left:50px" ></i>
			      
		          <span>标签</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-list"></i>
			
			娱乐
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/musics " style="margin-left:75px">
				  
				   <i class="fa fas fa-music" style="position: absolute;left:50px" ></i>
			      
		          <span>音乐</span>
                  </a>
                </li>
              
                <li>

                  <a href="/video " style="margin-left:75px">
				  
				   <i class="fa fas fa-film" style="position: absolute;left:50px" ></i>
			      
		          <span>电影</span>
                  </a>
                </li>
              
                <li>

                  <a href="/books " style="margin-left:75px">
				  
				   <i class="fa fas fa-book" style="position: absolute;left:50px" ></i>
			      
		          <span>书城</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-address-card"></i>
			
			关于
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/about " style="margin-left:75px">
				  
				   <i class="fa fas fa-user-circle" style="position: absolute;left:50px" ></i>
			      
		          <span>关于我</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/aboutme" class="waves-effect waves-light">
			
			    <i class="fa-fw fa fa-user-secret"></i>
			
			聚宝盒
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://blog.csdn.net/qq_45927003?spm=1000.2115.3001.5343" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://blog.csdn.net/qq_45927003?spm=1000.2115.3001.5343" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
                
    </nav>

</header>
                        



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/22.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Alex</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/%E5%AD%A6%E4%B9%A0%E5%9E%8B%E7%B4%A2%E5%BC%95/">
                                    <span class="chip bg-color">
                                        学习型索引
                                    </span>
                                </a>
                                
                        </div>
                        
                </div>
                <div class="col s5 right-align">
                    
                        <div class="post-cate">
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                                <a href="/categories/%E5%AD%A6%E4%B9%A0%E5%9E%8B%E7%B4%A2%E5%BC%95/" class="post-category">
                                    学习型索引
                                </a>
                                
                        </div>
                        
                </div>
            </div>

            <div class="post-info">
                
                    <div class="post-date info-break-policy">
                        <i class="far fa-calendar-minus fa-fw"></i>
                        发布日期:&nbsp;&nbsp;
                            2024-04-12
                    </div>
                    

                        
                            <div class="post-date info-break-policy">
                                <i class="far fa-calendar-check fa-fw"></i>
                                更新日期:&nbsp;&nbsp;
                                    2024-05-02
                            </div>
                            

                                
                                    <div class="info-break-policy">
                                        <i class="far fa-file-word fa-fw"></i>
                                        文章字数:&nbsp;&nbsp;
                                            10.7k
                                    </div>
                                    

                                        
                                            <div class="info-break-policy">
                                                <i class="far fa-clock fa-fw"></i>
                                                阅读时长:&nbsp;&nbsp;
                                                    40
                                                        分
                                            </div>
                                            

                                                
                                                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                                                        <i class="far fa-eye fa-fw"></i>
                                                        阅读次数:&nbsp;&nbsp;
                                                            <span id="busuanzi_value_page_pv"></span>
                                                    </div>
                                                    
            </div>
        </div>
        <hr class="clearfix">

        

                

                        <div class="card-content article-card-content">
                            <div id="articleContent">
                                <h1 id="ALEX-An-Updatable-Adaptive-Learned-Index"><a href="#ALEX-An-Updatable-Adaptive-Learned-Index" class="headerlink" title="ALEX: An Updatable Adaptive Learned Index"></a>ALEX: An Updatable Adaptive Learned Index</h1><hr>
<h2 id="整体数据结构设计"><a href="#整体数据结构设计" class="headerlink" title="整体数据结构设计"></a>整体数据结构设计</h2><p>ALEX旨在实现以下目标：</p>
<ol>
<li>插入时间应与 B+Tree 相当;</li>
<li>查找时间应比 B+Tree 和 Learned Index 快;</li>
<li>索引存储空间应小于 B+Tree 和 Learned Index;</li>
<li>数据存储空间(叶级)应与 动态B+Tree 相当。</li>
</ol>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/posts/53ff/image-20240412211819896.png" class title="Alex-Model">
<hr>
<h3 id="设计概览"><a href="#设计概览" class="headerlink" title="设计概览"></a>设计概览</h3><p>ALEX：内存中的可更新的学习型索引。但与学习索引亦有许多不同之处：</p>
<p>区别一：叶节点的数据结构。像B+Tree一样，ALEX在每个叶子上使用一个节点。这允许更灵活地扩展和分割单个节点，并且还限制了插入期间所需的移位次数。在典型的B+树中，每个叶节点存储一个键和有效负载数组，并且在数组末尾有“空闲空间”来吸收插入。ALEX使用了类似的设计，但更仔细地选择了如何使用空闲空间。通过在数组元素之间策略性地引入间隙，可以实现更快的插入和查找时间。如图2所示，ALEX对每个数据节点使用间隙数组(GA)布局。</p>
<p>区别二：ALEX使用指数搜索来搜索叶级键，以纠正RMI的错误预测，如图2所示。我们通过实验验证了无边界的指数搜索比有边界的二叉搜索更快。这是因为如果模型是好的，它们的预测就足够接近正确的位置。指数搜索还消除了在RMI模型中存储错误边界的需要。</p>
<p>区别三：ALEX在模型预测键应该在的位置将键插入数据节点。我们称之为基于模型的插入。相反，学习索引在不改变数组中记录位置的情况下对记录数组生成RMI。基于模型的插入具有更好的搜索性能，因为它减少了模型误预测误差。</p>
<p>区别四：ALEX根据工作量动态调整RMI的形状和高度。</p>
<p>区别五：ALEX没有需要为每个数据集或工作负载重新调整的参数，不像学习索引，其中必须调整模型的数量。ALEX通过使用 cost模型 自动批量加载和调整 RMI 结构以实现高性能。</p>
<hr>
<h3 id="节点布局"><a href="#节点布局" class="headerlink" title="节点布局"></a>节点布局</h3><h4 id="数据节点"><a href="#数据节点" class="headerlink" title="数据节点"></a>数据节点</h4><p>与B+树一样，ALEX的叶节点存储数据记录，因此被称为数据节点，如图2中的圆圈所示。</p>
<p>数据节点<strong>存储一个线性回归模型</strong>(斜率和截距的两个双值)，它将一个键映射到一个位置，<strong>以及两个gap数组</strong>，<strong>一个用于键，一个用于有效载荷</strong>。我们在图2中只显示了keys数组。默认情况下，键和有效负载都是固定大小的。(注意，有效负载可以是记录或指向可变大小记录的指针，存储在内存中单独分配的空间中)。出于实际原因，我们还强制设置了最大节点大小。</p>
<p>ALEX使用间隙数组布局，它使用基于模型的插入来分配数组元素之间的额外空间，从而实现更快的插入和查找。相反，B+Tree将所有的空格放在数组的末尾。</p>
<p><strong>间隙数组用间隙右边最近的键来填充间隙，这有助于保持指数搜索性能</strong>。</p>
<p><strong>为了在扫描时有效地跳过间隙，每个数据节点维护一个位图，该位图跟踪节点中的每个位置是否被键占用或是否为间隙。与间隙数组相比，位图查询速度快，空间开销低</strong>。</p>
<hr>
<h4 id="内部节点"><a href="#内部节点" class="headerlink" title="内部节点"></a>内部节点</h4><p>我们将作为RMI结构部分的所有节点称为内部节点，如图2中矩形所示。内部节点存储一个线性回归模型和一个包含指向子节点指针的数组。像B+树一样，内部节点直接遍历树，<strong>但与B+树不同的是，ALEX中的内部节点使用模型来“计算”指针数组中下一个子指针的位置</strong>。与数据节点类似，我们施加了一个最大节点大小。</p>
<p>ALEX 的内部节点在概念上与学习索引的目的不同。 LearnedIndex的内部节点有适合数据的模型；<strong>具有完美模型的内部节点将键平均分配给其子节点，并且具有完美内部节点的 RMI 会导致每个数据节点中的键数量相同</strong>。然而，<strong>RMI结构的目标不是产生相同大小的数据节点，而是产生键分布大致线性的数据节点，以便线性模型可以精确地拟合其键</strong>。</p>
<p>因此，ALEX中内部节点的作用就是提供一种灵活的方式来划分键空间。假设图3中的内部节点A覆盖了键空间[0,1)并且有四个子指针。 LearnedIndex 将为每个指针分配一个节点，可以是所有内部节点，也可以是所有数据节点。然而，ALEX 更灵活地划分空间。内部节点A将键空间[0,1/4)和[1/2,1)分配给数据节点（因为这些空间中的CDF是线性的），并将[1/4,1/2)分配给另一个内部节点（因为 CDF 是非线性的，并且 RMI 需要对该key空间进行更精细的划分）。<strong>如图所示，多个指针可以指向同一个子节点</strong>。</p>
<p>将每个内部节点中的指针数量始终限制为 2 的幂。这允许节点在不重新训练其子树的情况下进行分裂。</p>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/posts/53ff/image-20240412211959414.png" class title="img">
<hr>
<h2 id="算法设计"><a href="#算法设计" class="headerlink" title="算法设计"></a>算法设计</h2><h3 id="查找和范围查找"><a href="#查找和范围查找" class="headerlink" title="查找和范围查找"></a>查找和范围查找</h3><p>为了查找键，从 RMI 的根节点开始，迭代地使用模型来“计算”指针数组中的位置，然后沿着指针指向下一级的子节点，直到到达数据节点。通过构建，内部节点模型具有完美的精度，因此内部节点不涉及搜索。我们使用数据节点中的模型来预测键中搜索键的位置阵列，如果需要，进行指数搜索找到 key 的实际位置。如果找到键，我们从有效负载数组中读取同一位置的相应值并返回记录。否则，返回一个空记录。图2中直观地显示了（使用红色箭头）查找。范围查询首先执行查找以查找值不小于范围起始值的第一个键的位置和数据节点，然后向后扫描直到到达范围的结束值，<strong>使用节点的位图跳过间隙</strong>，并在必要时使用存储在节点中的指针跳转到下一个数据节点。【基于模型的查找O(1)+指数搜索】</p>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/posts/53ff/image-20240412212047079.png" class title="img">
<hr>
<h3 id="插入未满的数据节点"><a href="#插入未满的数据节点" class="headerlink" title="插入未满的数据节点"></a>插入未满的数据节点</h3><p>对于插入算法，到达正确数据节点（即TraverseToLeaf）的逻辑与上述查找算法相同。在未满数据节点中，为了找到新元素的插入位置，可使用数据节点中的模型来预测插入位置。如果预测位置不正确（插入到那里将无法保持排序顺序），则会进行指数搜索来找到正确的插入位置。</p>
<p>如果插入位置是一个间隙，则直接将元素插入到间隙中。<strong>否则，便通过将元素在最近间隙的方向上移动一个位置以在插入位置处形成一个间隙</strong>。然后将元素插入到新创建的间隙中。间隙数组以高概率实现 O(logn) 插入时间。</p>
<hr>
<h3 id="插入已满的数据节点"><a href="#插入已满的数据节点" class="headerlink" title="插入已满的数据节点"></a>插入已满的数据节点</h3><p>当数据节点已满时，ALEX 使用两种机制来创建更多空间：扩展和拆分。 ALEX 依靠简单的 cost 模型在不同的机制之间进行选择。</p>
<h4 id="节点饱满度的标准"><a href="#节点饱满度的标准" class="headerlink" title="节点饱满度的标准"></a>节点饱满度的标准</h4><p>ALEX 不会等待数据节点达到 100% 满，因为间隙数组上的插入性能会随着间隙数量的减少而恶化。我们引入间隙数组的密度下限和上限：d~l~,d~u~ ∈ (0,1]，约束条件是 d~l~&lt;d~u~。</p>
<p>密度定义为被元素填充的位置的分数。如果下一次插入导致超过 d~u~ ，则节点已满。默认情况下，我们设置 d~l~=0.6 和 d~u~=0.8，以实现平均数据存储利用率 0.7，类似于 B+Tree [14]，根据我们的实验，这总是会产生良好的结果，并且不需要调整。相反，B+Tree 节点通常具有 d~l~=0.5 和 d~u~=1。</p>
<h4 id="节点扩展机制"><a href="#节点扩展机制" class="headerlink" title="节点扩展机制"></a>节点扩展机制</h4><p>为了扩展包含 n 个键的数据节点，我们分配一个具有 n/d~l~ 个槽的新的更大的间隙数组。然后，我们缩放或重新训练线性回归模型，然后使用缩放或重新训练的模型对这个新的较大节点中的所有元素进行基于模型的插入。创建后，新数据节点处于密度下限 d~l~ 。</p>
<h4 id="节点分裂机制"><a href="#节点分裂机制" class="headerlink" title="节点分裂机制"></a>节点分裂机制</h4><p>为了将数据节点一分为二，即将 key 分配给两个新的数据节点，使得每个新节点负责原始节点的 key 空间的一半。 ALEX支持两种分割节点的方式：</p>
<ol>
<li><p><strong>横向拆分</strong>在概念上类似于 B+Tree 使用拆分的方式。有两种情况：</p>
<p>a）如果分裂数据节点的父内部节点尚未达到最大节点大小，则将父节点指向分裂数据节点的指针替换为指向两个新数据节点的指针。父内部节点的指针数组可能有指向拆分数据节点的冗余指针。如果是这样，我们将一半的冗余指针分配给两个新节点中的每一个。否则，我们通过将父节点指针数组的大小加倍并为每个指针制作冗余副本来创建指向拆分数据节点的第二个指针，然后将冗余指针之一赋予两个新节点中的每一个。图 5a 显示了不需要扩展父内部节点的横向拆分的示例。 </p>
<p>b) 如果父内部节点已达到最大节点大小，则可以选择拆分父内部节点，如图 5b 所示。请注意，通过将所有内部节点大小限制为 2 的幂，便始终以“边界保留”方式分割节点，因此不需要重新训练分割内部节点下方的任何模型。请注意，分裂可以一直传播到根节点，就像在 B+ 树中一样。</p>
</li>
</ol>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/posts/53ff/image-20240412212101573.png" class title="img">
<p>2) 纵向拆分将数据节点转换为具有两个子数据节点的内部节点，如图 5c 所示。<strong>两个子数据节点中的模型根据各自的键进行训练</strong>。 B+Tree 没有类似的分裂机制。</p>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/posts/53ff/image-20240412212111535.png" class title="image-20240412212111535">
<hr>
<h4 id="cost-模型"><a href="#cost-模型" class="headerlink" title="cost 模型"></a>cost 模型</h4><p>为了决定应用哪种机制，ALEX 依赖于简单的线性 cost 模型，该模型根据在每个数据节点跟踪出来的两个简单统计数据 来预测平均查找时间和插入时间：（a）指数搜索迭代的平均数; （b) 插入的平均移位次数。查找性能与（a）直接相关，而插入性能与（a）和（b）直接相关（因为插入首先需要进行查找以找到正确的插入位置）。</p>
<p><strong>这两个统计数据在创建数据节点时是未知的。为了找到新数据节点的预期 cost ，我们在假设对现有键统一进行查找并根据现有键分布进行插入的情况下计算这些统计数据的预期值</strong>。</p>
<p>具体来说：</p>
<p>(a) 被计算为所有键的模型预测误差的平均以 2 为底的对数； </p>
<p>(b) 计算所有现有键到间隙数组中最近间隙的平均距离。</p>
<p>这些期望值可以在不创建数据节点的情况下计算。如果数据节点是使用现有数据节点的键子集创建的，我们可以使用查找与插入的经验比率来衡量两个统计数据的相对重要性以进行计算预期 cost 。</p>
<p>除了节点内 cost 模型之外，ALEX 还使用 TraverseToLeaf cost 模型来预测从根节点遍历到数据节点的时间。 TraverseToLeaf cost 模型使用两个统计数据：</p>
<p>1) 遍历到的数据节点的深度；<br>2) 所有内部节点和数据节点元数据（除了key和有效负载之外的所有内容）的总大小（以B为单位）。</p>
<p>这些统计数据捕获了遍历的 cost ：较深的数据节点需要更多的指针追踪来查找，较大的大小会降低 CPU 缓存局部性，从而减慢对数据节点的遍历。我们提供有关 cost 模型的更多详细信息并在 [10] 的附录 D 中显示了它们的低使用开销。【<strong>计算叶节点深度，以及遍历到叶节点所需公共元数据大小</strong>】</p>
<hr>
<h4 id="插入算法"><a href="#插入算法" class="headerlink" title="插入算法"></a>插入算法</h4><p>当查找和插入在数据节点上完成时，就计算指数搜索迭代和每次插入的移位 次数。<strong>根据这些统计数据，我们使用节点内 cost 模型计算数据节点的经验 cost </strong>。<strong>一旦数据节点已满，就将预期 cost （在节点创建时计算）与经验 cost 进行比较。如果它们没有显著偏离，那么就断定模型仍然准确，就执行节点扩展（如果扩展后的大小小于最大节点大小），缩放模型而不是重新训练</strong>。 RMI 内部节点中的模型不会重新训练或重新缩放。</p>
<p><strong>显著 cost 偏差定义为：经验 cost 比预期 cost 高出 50% 以上</strong>。根据我们的实验，50% 的 cost 偏差阈值始终会产生良好的结果，无需进行调整。</p>
<p>否则，<strong>如果经验 cost 偏离了预期 cost ，就必须（i）扩展数据节点并重新训练模型，（ii）横向分割数据节点，或（iii）纵向分割数据节点。根据节点内 cost 模型，选择导致最低预期 cost 的操作</strong>。</p>
<p><strong>为简单起见，ALEX 始终将数据节点一分为二。数据节点在概念上可以拆分为 2 的任意幂，但确定最佳扇出可能非常耗时，我们通过实验验证，在大多数情况下，根据 cost 模型，2 的扇出是最佳的</strong>。</p>
<hr>
<h4 id="为什么经验-cost-会偏离预期-cost-？"><a href="#为什么经验-cost-会偏离预期-cost-？" class="headerlink" title="为什么经验 cost 会偏离预期 cost ？"></a>为什么经验 cost 会偏离预期 cost ？</h4><p>当 插入键 的分布不遵循现有键的分布时，通常会发生这种情况，从而导致模型变得不准确。不准确的模型可能会导致没有任何间隙的长连续区域。插入这些完全填充的区域需要移动其中最多一半的元素以创建间隙，在最坏的情况下这需要 O(n) 时间。随着节点变大，或由于查找的访问模式发生变化，性能也可能仅仅由于随机噪声而降低。</p>
<hr>
<h3 id="删除、更新"><a href="#删除、更新" class="headerlink" title="删除、更新"></a>删除、更新</h3><p>要删除key，则进行查找以找到key的位置，然后删除它及其有效负载。删除不会移动任何现有键，因此删除是比插入更简单的操作，并且不会导致模型准确性降低。如果数据节点由于删除而达到密度下限 d~l~，则 <strong>收缩</strong> 该数据节点以避免空间利用率低。此外，使用节点内 cost 模型来确定两个数据节点应该合并在一起并可能向上增长，从而局部将 RMI 深度减少 1。但是，为了简单起见，我们不实现这些合并操作。</p>
<p>【<strong>如何收缩？简单起见，不合并，要合并怎么办？效果会好吗</strong>？】</p>
<p>更新：修改键是通过组合插入和删除来实现的。仅修改有效负载的更新将查找 key 并将新值写入有效负载。</p>
<hr>
<h3 id="处理越界插入"><a href="#处理越界插入" class="headerlink" title="处理越界插入"></a>处理越界插入</h3><p>低于或高于现有键空间的键将分别插入到最左边或最右边的数据节点中。一系列越界插入（如仅追加插入工作负载）将导致性能不佳，因为该数据节点没有分裂越界键空间的机制。因此，ALEX有两种方式可以顺利处理越界插入。</p>
<p>首先，当检测到现有键空间之外的插入时，ALEX 将扩展根节点，从而扩展键空间，如图 6 所示。可将子指针数组的大小向右扩展。指向现有子项的现有指针不会被修改。为扩展的指针数组中的每个新槽创建一个新的数据节点。若此扩展导致根节点超过最大节点大小，ALEX 将创建一个新的根节点。新根节点的第一个子指针将指向旧根节点，并为新根节点的其他每个指针槽创建一个新数据节点。最后，越界键将落入新创建的数据节点之一。</p>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/posts/53ff/image-20240412212122272.png" class title="img">
<p>其次，ALEX 最右边的数据节点通过 维护节点中最大键的值 并 保留插入超过最大值的计数器 来检测追加插入行为。如果大多数【<strong>是根据计数器大小判断</strong>？】插入超过最大值，则意味着仅追加行为，因此数据节点向右扩展，而不进行基于模型的重新插入；扩展的空间最初保持为空，以期待更多类似附加的插入。</p>
<hr>
<h3 id="批量加载"><a href="#批量加载" class="headerlink" title="批量加载"></a>批量加载</h3><p>ALEX 支持批量加载操作，该操作在实践中用于在初始化时索引大量数据或重建索引。我们的目标是找到一个 cost 最小的 RMI 结构，cost 定义为在此 RMI 上执行操作（即查找或插入）的预期平均时间。任何 ALEX 操作都是由到数据节点的 TraverseToLeaf 和节点内操作组成，因此 RMI cost 是通过结合 TraverseToLeaf 和节点内 cost 模型来建模的。</p>
<h4 id="批量加载算法"><a href="#批量加载算法" class="headerlink" title="批量加载算法"></a>批量加载算法</h4><p>使用 cost 模型，从根节点开始贪婪地向下增长 RMI。在每个节点，独立地决定该节点应该是数据节点还是内部节点，以及在后一种情况下，扇出应该是什么。<strong>扇出必须是2的幂，子节点将平分当前节点的key空间</strong>。</p>
<p>在每个节点本地就可做出此决策，因为使用线性 cost 模型，决策将对 RMI 的总体 cost 产生纯粹的累加效应。如果该节点是内部节点，则将在其每个子节点上递归。这将持续下去，直到所有数据都加载到 ALEX 中。</p>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/posts/53ff/image-20240412212129080.png" class title="img">
<h4 id="扇出树"><a href="#扇出树" class="headerlink" title="扇出树"></a>扇出树</h4><p>随着 RMI 的发展，主要挑战是确定每个节点的最佳扇出。</p>
<p>引入扇出树（FT）概念，它是一棵完全二叉树。 FT 将帮助决定单个 RMI 节点的扇出；在批量加载算法中，每次决定 RMI 节点的最佳扇出时，都构造一个 FT 树。<strong>扇出为 1 意味着 RMI 节点应该是数据节点</strong>。</p>
<p>图 7 显示了 FT 示例。每个 FT 节点代表 RMI 节点的一个可能的子节点。如果 RMI 节点的 key 空间为[0,1)，则在某个具有 n 个节点的层级上，第 i 个 FT 节点表示 key 空间为 [i/n,(i+1)/n) 的 子RMI节点。每个 FT 节点都与在其 key 空间上构建数据节点的预期 cost 相关联，如节点内 cost 模型所预测的那样。目标是以最小的总体 cost 找到一组覆盖 RMI 节点整个 key 空间的 FT 节点。</p>
<p>覆盖集的总体 cost 是其 FT 节点 cost 以及由于模型大小而导致的 TraverseToLeaf cost 之和（如在 FT 中深入一层意味着 RMI 节点必须具有两倍的指针）。该覆盖集决定了 RMI 节点的最佳扇出（即子指针的数量）以及分配子指针的最佳方式。</p>
<p>使用以下方法来找到低 cost 的覆盖集：</p>
<ol>
<li>从FT根开始，一次增长FT的整个级别，并计算使用每个级别作为覆盖集的 cost 。继续这样做，直到每个连续级别的 cost 开始增加。在图 7 中，级别 2 的综合 cost 最低，则不再继续增长级别 3 之后的。从概念上讲，更深的级别可能具有较低的 cost ，但计算每个 FT 节点的 cost 是昂贵的。 </li>
</ol>
<p>2) 从组合 cost 最低的 FT 级别开始，开始本地合并或分裂 FT 节点。如果两个相邻 FT 节点的 cost 高于其父节点的 cost ，则合并（例如， cost 为 20 和 25 的节点合并为 cost 为 40 的节点）；当两个节点的键很少或它们的分布相似时，可能会发生这种情况。另一方面，如果 FT 节点的 cost 高于其两个子节点的 cost ，则分割 FT 节点（例如， cost 为 10 的节点被分割为两个 cost 为 1 的节点）；当 key 空间的两半具有不同的分布时，可能会发生这种情况。继续在本地合并和分裂相邻节点的过程，直到不再可能为止。</p>
<p>最后，返回生成的 FT 节点覆盖集。</p>
<p>【<strong>大大的问题：经验 cost 和预期 cost 是怎么计算的，FT树的每个层级中的 cost 是怎么计算的？怎么和RMI对应的？该问题中，层级2 cost 最小，完事怎么又合并分裂了</strong>？】</p>
<hr>
<h2 id="ALEX分析"><a href="#ALEX分析" class="headerlink" title="ALEX分析"></a>ALEX分析</h2><h3 id="RMI-深度的限制"><a href="#RMI-深度的限制" class="headerlink" title="RMI 深度的限制"></a>RMI 深度的限制</h3><p>让 m 为最大节点大小，以槽数定义（在内部节点的指针数组中，在数据节点的间隙数组中）。将节点大小限制为 2 的幂： m = 2^k^ 。内部节点最多可以有 m 多个子指针，数据节点包含的键不得超过 md~u~ 个。让所有要索引的键都落在键空间 s 内。令 p 为分区的最小数量，使得当 key 空间 s 被划分为 p 个宽度相等的分区时，每个分区包含的 key 不超过 md~u~ 个。定义根节点深度为0。</p>
<p>定理5.1：可以构造一个满足最大节点大小和密度上限约束的 RMI，其深度不大于 ⌈log~m~p⌉——称之为最大深度。此外，可以保持插入下的最大深度。（请注意，p 在插入下可能会发生变化）</p>
<p>换句话说，RMI 的深度受到 <strong>s 最密集子区域的密度的限制</strong>。相比之下，B+树将深度限制为键数量的函数。定理 5.1 也可以应用于 s 内的子空间，它对应于 RMI 内的某个子树。</p>
<p>证明。构建具有最大深度的 RMI 非常简单。跨越大小为 |s|/p 的键空间的<strong>最密集子区域</strong>【<strong>如何甄别</strong>？】被分配给数据节点。从根到这个最密集区域的遍历路径由内部节点组成，每个内部节点有 m 个子指针。它需要 ⌈log~m~p⌉ 内部节点来缩小 |s| 的 key 空间大小至 |s|/p。为了最小化 RMI 的其他子树的深度，我们将这种构造机制递归地应用于空间 s 的其余部分。</p>
<p>从满足最大深度的 RMI 开始，我们使用 4.3 节中的机制根据以下策略维持最大深度： (1) 数据节点扩展直到达到最大节点大小。 (2) 当数据节点由于最大节点大小而必须分裂时，它会横向分裂以维持当前深度（可能将分裂传播到某个祖先内部节点）。(3) 当不再可能横向分裂时（所有祖先节点都处于最大节点大小），向下分裂。</p>
<p><strong>通过遵循此策略，RMI 仅当 p 增长 m 倍时才向下分裂，从而保持最大深度</strong>。</p>
<h3 id="复杂性分析"><a href="#复杂性分析" class="headerlink" title="复杂性分析"></a>复杂性分析</h3><p>查找和插入都在 ⌈log~m~ p⌉ 时间内完成 TraverseToLeaf。在数据节点内，查找的指数搜索在最坏情况下受 O(logm) 限制。在最好的情况下，数据节点模型完美地预测了 key 的位置，并且查找需要 O(1) 时间。</p>
<p>未满节点的插入由查找组成，后面可能会进行移位以引入新键的间隙。在最坏的情况下，这受到 O(m) 的限制，但由于间隙数组以高概率实现每次插入 O(logm) 次移位，因此预计大多数情况下的复杂性为 O(logm)。在最好的情况下，预测的插入位置是正确的并且是一个间隙，则将 key 准确地放置在模型预测的位置，插入复杂度为 O(1) ；此外，稍后基于模型的查找将导致直接命中 O(1)。</p>
<p>cost 由必须复制的元素数量来定义： (1)数据节点的扩展，其 cost 以O(m)为界。 (2)向下分裂成两个节点，其 cost 为O(m)。 (3) 横向分裂成两个节点，并在路径中向上传播到某个祖先节点，其 cost 受 O(m⌈log~m~p⌉) 限制，因为该路径上的每个内部节点也必须分裂。因此，插入全节点的最坏情况性能为 O(m⌈log~m~p⌉)。</p>
<hr>
<h2 id="实验评估"><a href="#实验评估" class="headerlink" title="实验评估"></a>实验评估</h2><p>使用各种数据集和工作负载将 ALEX 与学习索引、B+树、模型增强的 B+树 和 自适应基数树 (ART) 进行比较。此次评估表明：</p>
<ul>
<li>在只读工作负载上，ALEX 的吞吐量比 B+Tree、学习索引、模型B+树和ART 高出 4.1 倍、2.2 倍、2.9 倍、3.0 倍；索引大小小 800 倍、15 倍、160 倍、8000 倍。</li>
<li>在读写工作负载上，ALEX 的吞吐量分别比 B+Tree、模型 B+Tree 和 ART 高 4.0×、2.7×、2.7×，索引大小分别小 2000×、475×、36000×。</li>
<li><p>ALEX 具有竞争力的批量加载时间，并且在扩展到更大的数据集以及由于数据倾斜而导致分布变化时，保持优于其他索引的优势。</p>
</li>
<li><p>Gapped Array 和自适应 RMI 结构使 ALEX 能够适应不同的数据集和工作负载。</p>
</li>
</ul>
<hr>
<h4 id="数据集"><a href="#数据集" class="headerlink" title="数据集"></a>数据集</h4><p>使用来自某些数据集的 8 字节密钥和随机生成的固定大小的有效负载来运行所有实验。我们在 4 个数据集上评估 ALEX，其特征和 CDF 如表 1 和图 8 所示。经度数据集由 Open Street Maps [2] 中世界各地位置的经度组成。 longlat 数据集由复合键组成，这些复合键通过对每对经度和纬度应用变换 k =180·floor(经度)+纬度来组合来自开放街道地图的经度和纬度。由此产生的 keys k 分布是高度非线性的。对数正态数据集的值根据对数正态分布生成，其中 µ =0 且 σ =2，乘以 10^9^ 并向下舍入到最接近的整数。 YCSB 数据集具有表示根据 YCSB 基准 [8] 生成的用户 ID 的值，这些值均匀分布在整个 64 位域中，并使用 80 字节的有效负载。这些数据集不包含重复值。除非另有说明，否则这些数据集会随机打乱以模拟随时间变化的均匀数据集分布.</p>
<h4 id="工作负载"><a href="#工作负载" class="headerlink" title="工作负载"></a>工作负载</h4><p>我们评估 ALEX 的主要指标是平均吞吐量。我们评估五种工作负载的吞吐量：(1) 只读工作负载，(2) 包含 95% 读取和 5% 插入的读密集型工作负载，(3) 包含 50% 读取和 50% 插入的写密集型工作负载， (4) 具有 95% 读取和 5% 插入的短程查询工作负载，以及 (5) 只写工作负载，以完成读写范围。对于前三个工作负载，读取由单个键的查找组成。对于短程工作负载，读取由键查找和后续键扫描组成。要扫描的键的数量是从最大扫描长度为 100 的均匀分布中随机选择的。对于所有工作负载，要查找的键是根据 Zipfian 分布从索引中现有键的集合中随机选择的。前四个工作负载大致分别对应于 YCSB 基准 [8] 中的工作负载 C、B、A 和 E。对于给定的数据集，我们用 1 亿个键初始化一个索引。然后，我们运行工作负载 60 秒，插入剩余的密钥。我们报告当时完成的操作的吞吐量，其中操作要么是插入，要么是读取。对于读写工作负载，我们交错操作：对于读密集型工作负载和短范围工作负载，我们执行 19 次读取/扫描，然后执行 1 次插入，然后重复该循环；<strong>对于写入密集型工作负载，我们执行 1 次读取，然后执行 1 次插入，然后重复该循环</strong>。</p>
<hr>
<h3 id="Drilldown-into-ALEX-Design-Trade-offs"><a href="#Drilldown-into-ALEX-Design-Trade-offs" class="headerlink" title="Drilldown into ALEX Design Trade-offs"></a>Drilldown into ALEX Design Trade-offs</h3><p>在本节中，我们将深入探讨节点布局和自适应 RMI 如何帮助 ALEX 实现其设计目标。</p>
<p>ALEX 相对于学习索引的部分优势来自于在数据节点中使用基于模型的插入和间隙数组，但 ALEX 对于动态工作负载的大部分优势来自于<strong>自适应 RMI</strong>。</p>
<p>为了演示每个贡献的效果，图 13 显示，采用 2 层学习索引并用每个叶的间隙数组（LI w/Gapped Array）替换单个密集值数组，对于只读工作负载，已经比学习索引实现了显着的加速。然而，带有间隙数组的学习索引在读写工作负载上的性能较差，因为存在完全填充的区域，需要为每次插入移动许多键。 ALEX 使 RMI 结构适应数据的能力对于良好的插入性能是必要的。</p>
<p>在查找过程中，大部分时间都花在围绕预测位置进行本地搜索。较小的预测误差直接有助于减少查找时间。为了分析 Learned Index 和 ALEX 的预测误差，我们用经度数据集中的 1 亿个键初始化一个索引，使用该索引来预测这 1 亿个键中每个键的位置，并跟踪预测位置与实际位置之间的距离。图 14a 显示学习索引在模式大约 8-32 个位置处存在预测误差，并且右侧有长尾。另一方面，ALEX 通过使用基于模型的插入实现了低得多的预测误差。</p>
<p>图14b显示，初始化后，ALEX通常没有预测误差，发生的误差通常很小，并且误差的长尾已经消失。图 14c 显示，即使在 2000 万次插入之后，ALEX 仍保持较低的预测误差。</p>
<p>一旦数据节点变满，就会发生以下四种操作之一：如果不存在 cost 偏差，则 (1) 扩展节点并缩放模型。否则，节点要么 (2) 扩展并重新训练其模型，(3) 横向分割，或 (4) 向下分割。表 3 显示，在绝大多数情况下，数据节点只是扩展，模型也进行了缩放，这意味着即使在插入之后模型通常仍然保持准确（假设没有发生根本的分布变化）。数据节点变满的次数与数据节点的数量相关（表2）。在YCSB上，通过模型再训练进行扩展更为常见，因为数据节点很大，因此 cost 偏差通常只是由随机性引起的。</p>
<p>如果需要，用户可以调整最大节点大小以实现目标尾部延迟。在图 15 中，我们在经度数据集上运行写入密集型工作负载，测量每个操作的延迟。随着我们增加最大节点大小，ALEX 的中值甚至 p99 延迟都会减少，因为 ALEX 具有更大的灵活性来构建性能更好的 RMI（例如，具有更高的内部节点扇出的能力）。然而，最大延迟会增加，因为触发大节点扩展或分裂的插入速度很慢。如果用户对延迟有严格要求，则可以相应减小最大节点大小。将最大节点大小增加到超过 64MB 后，延迟不会改变，因为 ALEX 从未决定使用大于 64MB 的节点。</p>
<hr>
<h4 id="搜索方法比较"><a href="#搜索方法比较" class="headerlink" title="搜索方法比较"></a>搜索方法比较</h4><p>为了展示指数搜索和其他搜索方法之间的权衡，我们对合成数据进行了微基准测试。我们创建一个包含 1 亿个完全均匀分布的双精度数的数据集。然后，我们从该数据集中搜索 1000 万个随机选择的值。我们使用三种搜索方法：二分搜索和有偏四元搜索（在[20]中提出，以利用准确的预测），每种方法都使用两种不同的误差范围大小进行评估，以及指数搜索。对于每次查找，搜索方法都会得到一个预测位置，该位置与实际位置值的距离存在一定的综合误差量。图 16 显示，指数搜索的搜索时间与错误大小的对数成比例增加，而二分搜索方法花费恒定的时间，而与错误大小无关。这是因为二分查找必须始终在其误差范围内开始搜索，并且无法利用误差较小的情况。因此，如果 ALEX 中 RMI 模型的预测误差较小，指数搜索应该优于二分搜索。正如我们在第 6.3 节中所示，ALEX 通过基于模型的插入保持较低的预测误差。</p>
<p>因此，ALEX 非常适合利用指数搜索。当误差低于 σ 时（我们在本实验中设置 σ = 8；详细信息请参阅[20]），有向四元搜索与指数搜索具有竞争力，因为搜索可以限制在较小的范围内，但当误差超过 σ 时，其性能与二分搜索类似因为必须搜索完整的错误界限。与有偏差的四元搜索相比，我们更喜欢指数搜索，因为它的性能下降更平滑且实现简单（例如，无需调整 σ）。</p>
<p>参考博文：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/435878936">指数搜索 - 知乎 (zhihu.com)</a> </p>
<hr>
<h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><p>我们在学习索引令人兴奋的基础上提出了 ALEX，这是一种新的可更新学习索引，它有效地将学习索引的核心见解与经过验证的存储和索引技术结合起来。具体来说，我们提出了一种间隙数组节点布局，它使用基于模型的插入和指数搜索，结合简单 cost 模型驱动的自适应 RMI 结构，以在动态工作负载上实现高性能和低内存占用。我们深入的实验结果表明，ALEX 不仅在读写工作负载范围内始终优于 B+Tree，甚至在所有数据集上，对于只读工作负载，其性能比现有的学习索引高出 2.2 倍。</p>
<p>我们相信这篇论文为我们的社区提供了重要的经验教训，并为该领域的未来研究开辟了道路。</p>
<p>我们打算研究有关 ALEX 性能的开放理论问题，<strong>支持大于内存数据集的二级存储，以及针对 ALEX 设计量身定制的新并发控制技术</strong>。</p>
<p>【<strong>方向：二级学习型索引，并发控制的学习型索引</strong>】</p>
<hr>
<h2 id="代码结构"><a href="#代码结构" class="headerlink" title="代码结构"></a>代码结构</h2><h3 id="类及属性"><a href="#类及属性" class="headerlink" title="类及属性"></a>类及属性</h3><h4 id="alex-base-h"><a href="#alex-base-h" class="headerlink" title="alex_base.h"></a>alex_base.h</h4><h5 id="线性回归模型"><a href="#线性回归模型" class="headerlink" title="线性回归模型"></a>线性回归模型</h5><pre class=" language-lang-c++"><code class="language-lang-c++">template<class T>
class LinearModel {
public:
    double a_ = 0;  // 斜率
    double b_ = 0;  // 截距

    LinearModel() = default;

    LinearModel(double a, double b) : a_(a), b_(b) {}

    // 拷贝构造函数
    explicit LinearModel(const LinearModel &other) : a_(other.a_), b_(other.b_) {}

    // 根据给定的扩展因子（expansion_factor）来扩展线性模型的斜率和截距
    void expand(double expansion_factor) {
        a_ *= expansion_factor;
        b_ *= expansion_factor;
    }

    // 预测 key 的 position_int
    inline int predict(T key) const {
        return static_cast<int>(a_ * static_cast<double>(key) + b_);
    }

    // 预测 key 的 position_double
    inline double predict_double(T key) const {
        return a_ * static_cast<double>(key) + b_;
    }
};
</code></pre>
<h5 id="构造线性回归"><a href="#构造线性回归" class="headerlink" title="构造线性回归"></a>构造线性回归</h5><pre class=" language-lang-c++"><code class="language-lang-c++">template<class T>
class LinearModelBuilder {
public:
    // 指向LinearModel<T>对象的指针，用于存储构建的线性模型
    LinearModel <T> *model_;

    explicit LinearModelBuilder<T>(LinearModel <T> *model) : model_(model) {}

    // 该函数会更新相关的统计信息，包括计数、x和y的总和、x的平方总和、x和y的乘积总和以及x和y的最小值和最大值
    inline void add(T x, int y) {
        count_++;
        x_sum_ += static_cast<long double>(x);y_sum_ += static_cast<long double>(y);
        xx_sum_ += static_cast<long double>(x) * x;xy_sum_ += static_cast<long double>(x) * y;
        x_min_ = std::min<T>(x, x_min_);x_max_ = std::max<T>(x, x_max_);
        y_min_ = std::min<double>(y, y_min_);y_max_ = std::max<double>(y, y_max_);
    }

private:
    // 整型变量，表示已添加的数据点的数量
    int count_ = 0;
    // 长双精度浮点型变量，表示所有数据点的x值的总和
    long double x_sum_ = 0;
    // 长双精度浮点型变量，表示所有数据点的y值的总和
    long double y_sum_ = 0;
    // 长双精度浮点型变量，表示所有数据点的x值的平方总和
    long double xx_sum_ = 0;
    // 长双精度浮点型变量，表示所有数据点的x值和y值的乘积总和
    long double xy_sum_ = 0;

    T x_min_ = std::numeric_limits<T>::max();
    T x_max_ = std::numeric_limits<T>::lowest();
    double y_min_ = std::numeric_limits<double>::max();
    double y_max_ = std::numeric_limits<double>::lowest();
};
</code></pre>
<p><strong>build 方法构建模型</strong>：</p>
<pre class=" language-lang-c++"><code class="language-lang-c++">void build() {
    if (count_ <= 1) {
        model_->a_ = 0;
        model_->b_ = static_cast<double>(y_sum_);
        return;
    }

    if (static_cast<long double>(count_) * xx_sum_ - x_sum_ * x_sum_ == 0) {
        // all values in a bucket have the same key.
        model_->a_ = 0;
        model_->b_ = static_cast<double>(y_sum_) / count_;
        return;
    }

    auto slope = static_cast<double>(
        (static_cast<long double>(count_) * xy_sum_ - x_sum_ * y_sum_) /
        (static_cast<long double>(count_) * xx_sum_ - x_sum_ * x_sum_));

    auto intercept = static_cast<double>(
        (y_sum_ - static_cast<long double>(slope) * x_sum_) / count_);
    model_->a_ = slope;
    model_->b_ = intercept;

    // If floating point precision errors, fit spline
    if (model_->a_ <= 0) {
        if (x_max_ - x_min_ == 0) {
            model_->a_ = 0;
            model_->b_ = static_cast<double>(y_sum_) / count_;
        } else {
            model_->a_ = (y_max_ - y_min_) / (x_max_ - x_min_);
            model_->b_ = -static_cast<double>(x_min_) * model_->a_;
        }
    }
}
</code></pre>
<hr>
<h5 id="工具方法"><a href="#工具方法" class="headerlink" title="工具方法"></a>工具方法</h5><pre class=" language-lang-c++"><code class="language-lang-c++">/*** Helper methods for bitmap ***/

// Extract the rightmost 1 in the binary representation.
// e.g. extract_rightmost_one(010100100) = 000000100
inline uint64_t extract_rightmost_one(uint64_t value) {
    return value & -static_cast<int64_t>(value);
}

// Remove the rightmost 1 in the binary representation.
// e.g. remove_rightmost_one(010100100) = 010100000
inline uint64_t remove_rightmost_one(uint64_t value) {
    return value & (value - 1);
}

// Count the number of 1s in the binary representation.
// e.g. count_ones(010100100) = 3
inline int count_ones(uint64_t value) {
    return static_cast<int>(_mm_popcnt_u64(value));
}

// Get the offset of a bit in a bitmap.
// word_id is the word id of the bit in a bitmap
// bit is the word that contains the bit
inline int get_offset(int word_id, uint64_t bit) {
    // 返回该位在位图中的偏移量
    return (word_id << 6) + count_ones(bit - 1);
}

// https://stackoverflow.com/questions/364985/algorithm-for-finding-the-smallest-power-of-two-thats-greater-or-equal-to-a-giv
// 返回大于或等于x的最小2的幂次方数
inline int pow_2_round_up(int x) {
    --x;
    x |= x >> 1;
    x |= x >> 2;
    x |= x >> 4;
    x |= x >> 8;
    x |= x >> 16;
    return x + 1;
}

// https://stackoverflow.com/questions/994593/how-to-do-an-integer-log2-in-c
// 返回小于或等于x的最大2的幂次方数的指数
inline int log_2_round_down(int x) {
    int res = 0;
    while (x >>= 1) ++res;
    return res;
}
</code></pre>
<h5 id="统计方法"><a href="#统计方法" class="headerlink" title="统计方法"></a>统计方法</h5><pre class=" language-lang-c++"><code class="language-lang-c++">/*** Cost model weights ***/

// Intra-node cost weights
constexpr double kExpSearchIterationsWeight = 20;
constexpr double kShiftsWeight = 0.5;

// TraverseToLeaf cost weights
constexpr double kNodeLookupsWeight = 20;
constexpr double kModelSizeWeight = 5e-7;

/*** Stat Accumulators ***/
// 统计数据节点的搜索迭代次数和位移数量
struct DataNodeStats {
    double num_search_iterations = 0;
    double num_shifts = 0;
};

// Used when stats are computed using a sample
// 用于在计算统计数据时使用样本
struct SampleDataNodeStats {
    // 样本大小的对数
    double log2_sample_size = 0;
    // 搜索迭代次数
    double num_search_iterations = 0;
    // 位移数量的对数
    double log2_num_shifts = 0;
};

// Accumulates stats that are used in the cost model, based on the actual vs
// predicted position of a key
class StatAccumulator {
    public:
    virtual ~StatAccumulator() = default;
    // 用于根据实际位置和预测位置来累积统计信息
    virtual void accumulate(int actual_position, int predicted_position) = 0;
    // 用于获取当前的统计信息
    virtual double get_stat() = 0;
    // 重置统计信息
    virtual void reset() = 0;
};
</code></pre>
<p><strong>计算预期的指数搜索迭代次数</strong>：</p>
<pre class=" language-lang-c++"><code class="language-lang-c++">
// Mean log error represents the expected number of exponential search iterations when doing a lookup
class ExpectedSearchIterationsAccumulator : public StatAccumulator {
    public:
    // 计算预期的指数搜索迭代次数
    void accumulate(int actual_position, int predicted_position) override {
        // 计算实际位置和预测位置之间的差的绝对值加1的对数
        cumulative_log_error_ +=
            std::log2(std::abs(predicted_position - actual_position) + 1);
        count_++;
    }

    double get_stat() override {
        if (count_ == 0) return 0;
        // 返回当前的平均对数误差
        return cumulative_log_error_ / count_;
    }

    void reset() override {
        cumulative_log_error_ = 0;
        count_ = 0;
    }

    public:
    double cumulative_log_error_ = 0;
    int count_ = 0;
};
</code></pre>
<p><strong>计算预期的插入操作中的移位次数</strong>：</p>
<pre class=" language-lang-c++"><code class="language-lang-c++">// Mean shifts represents the expected number of shifts when doing an insert
class ExpectedShiftsAccumulator : public StatAccumulator {
public:
    explicit ExpectedShiftsAccumulator(int data_capacity)
        : data_capacity_(data_capacity) {}

    // A dense region of n keys will contribute a total number of expected shifts
    // of approximately
    // ((n-1)/2)((n-1)/2 + 1) = n^2/4 - 1/4
    // This is exact for odd n and off by 0.25 for even n.
    // Therefore, we track n^2/4.
    void accumulate(int actual_position, int) override {
        if (actual_position > last_position_ + 1) {
            long long dense_region_length = last_position_ - dense_region_start_idx_ + 1;
            num_expected_shifts_ += (dense_region_length * dense_region_length) / 4;
            dense_region_start_idx_ = actual_position;
        }
        last_position_ = actual_position;
        count_++;
    }

    double get_stat() override {
        if (count_ == 0) return 0;
        // first need to accumulate statistics for current packed region
        long long dense_region_length = last_position_ - dense_region_start_idx_ + 1;
        long long cur_num_expected_shifts =
            num_expected_shifts_ + (dense_region_length * dense_region_length) / 4;
        return cur_num_expected_shifts / static_cast<double>(count_);
    }

    void reset() override {
        last_position_ = -1;
        dense_region_start_idx_ = 0;
        num_expected_shifts_ = 0;
        count_ = 0;
    }

public:
    int last_position_ = -1;            // 最后一个位置
    int dense_region_start_idx_ = 0;    // 密集区域的起始索引
    long long num_expected_shifts_ = 0; // 预期的移位次数
    int count_ = 0;
    int data_capacity_ = -1;            // 节点的容量
};
</code></pre>
<hr>
<h4 id="alex-node-h"><a href="#alex-node-h" class="headerlink" title="alex_node.h"></a>alex_node.h</h4><p><strong>宏定义，控制编译条件</strong>：</p>
<pre class=" language-lang-c++"><code class="language-lang-c++">// Whether we store key and payload arrays separately in data nodes
// By default, we store them separately
#define ALEX_DATA_NODE_SEP_ARRAYS 1

#if ALEX_DATA_NODE_SEP_ARRAYS
#define ALEX_DATA_NODE_KEY_AT(i) key_slots_[i]
#define ALEX_DATA_NODE_PAYLOAD_AT(i) payload_slots_[i]
#else
#define ALEX_DATA_NODE_KEY_AT(i) data_slots_[i].first
#define ALEX_DATA_NODE_PAYLOAD_AT(i) data_slots_[i].second
#endif

// Whether we use lzcnt and tzcnt when manipulating a bitmap (e.g., when finding the closest gap).
// If your hardware does not support lzcnt/tzcnt (e.g., your Intel CPU is pre-Haswell), set this to 0.
#define ALEX_USE_LZCNT 1
</code></pre>
<h5 id="AlexNode"><a href="#AlexNode" class="headerlink" title="AlexNode"></a>AlexNode</h5><pre class=" language-lang-c++"><code class="language-lang-c++">// A parent class for both types of ALEX nodes
template<class T, class P>
class AlexNode {
public:
    // Whether this node is a leaf (data) node
    bool is_leaf_ = false;

    // Power of 2 to which the pointer to this node is duplicated in its parent model node
    // For example, if duplication_factor_ is 3, then there are 8 redundant
    // pointers to this node in its parent
    // 指向这个节点的指针在其父模型节点中被复制的次数。
    // 例如，如果duplication_factor_为3，那么在其父节点中有8个指向这个节点的冗余指针
    uint8_t duplication_factor_ = 0;

    // Node's level in the RMI. Root node is level 0
    short level_ = 0;

    // Both model nodes and data nodes nodes use models
    LinearModel<T> model_;

    // Could be either the expected or empirical cost, depending on how this field is used
    double cost_ = 0.0;

    AlexNode() = default;

    explicit AlexNode(short level) : level_(level) {}

    AlexNode(short level, bool is_leaf) : is_leaf_(is_leaf), level_(level) {}

    virtual ~AlexNode() = default;

    // The size in bytes of all member variables in this class
    virtual long long node_size() const = 0;
};
</code></pre>
<h5 id="AlexModelNode"><a href="#AlexModelNode" class="headerlink" title="AlexModelNode"></a>AlexModelNode</h5><pre class=" language-lang-c++"><code class="language-lang-c++">template<class T, class P, class Alloc = std::allocator<std::pair<T, P>>>
class AlexModelNode : public AlexNode<T, P> {
public:
    // 类型别名: 当前类的类型
    typedef AlexModelNode<T, P, Alloc> self_type;
    // 定义一个类型别名 alloc_type,它是 Alloc 分配器类针对 self_type 类型的特化版本的类型
    typedef typename Alloc::template rebind<self_type>::other alloc_type;
    typedef typename Alloc::template rebind<AlexNode<T, P> *>::other pointer_alloc_type;

    const Alloc &allocator_;

    // Number of logical children. Must be a power of 2
    int num_children_ = 0;

    // Array of pointers to children
    AlexNode<T, P> **children_ = nullptr;    // 指向子节点的指针数组

    // 构造函数1：使用默认分配器初始化对象
    explicit AlexModelNode(const Alloc &alloc = Alloc())
            : AlexNode<T, P>(0, false), allocator_(alloc) {}

    // 构造函数2：使用指定的层级和默认分配器初始化对象
    explicit AlexModelNode(short level, const Alloc &alloc = Alloc())
            : AlexNode<T, P>(level, false), allocator_(alloc) {}

    ~AlexModelNode() {
        if (children_ == nullptr) {
            return;
        }

        // 调用 pointer_allocator() 函数获取分配器对象,
        // 并使用其 deallocate 方法释放 children_ 指向的内存空间. num_children_ 参数指定要释放的多少
        pointer_allocator().deallocate(children_, num_children_);
    }

    AlexModelNode(const self_type &other) : AlexNode<T, P>(other), allocator_(other.allocator_),
                                            num_children_(other.num_children_) {
        // 使用分配器对象pointer_allocator()分配一块内存空间,大小为other.num_children_个指针的大小,
        // 并将返回的指针赋值给children_
        children_ = new(pointer_allocator().allocate(other.num_children_))
                AlexNode<T, P> *[other.num_children_];
        // 将other对象的子节点指针数组复制到当前对象的子节点指针数组中
        std::copy(other.children_, other.children_ + other.num_children_, children_);
    }

    // Given a key, traverses to the child node responsible for that key
    // 根据给定的键（key）获取对应的子节点指针
    inline AlexNode<T, P> *get_child_node(const T &key) {
        int bucketID = this->model_.predict(key);
        bucketID = std::min<int>(std::max<int>(bucketID, 0), num_children_ - 1);
        return children_[bucketID];
    }

    pointer_alloc_type pointer_allocator() {
        return pointer_alloc_type(allocator_);
    }

    // 计算节点的大小,包括当前对象的大小以及子节点指针数组的大小
    long long node_size() const override {
        long long size = sizeof(self_type);
        size += num_children_ * sizeof(AlexNode<T, P> *);  // pointers to children
        return size;
    }
};
</code></pre>
<p><strong>内部节点扩展</strong>：</p>
<pre class=" language-lang-c++"><code class="language-lang-c++">// Expand by a power of 2 by creating duplicates of all existing child pointers.
// Input is the base 2 log of the expansion factor, in order to guarantee expanding by a power of 2.
// Returns the expansion factor.
// 通过创建现有子指针的副本来将数据结构扩展到2的幂次方大小
int expand(int log2_expansion_factor) {
    assert(log2_expansion_factor >= 0);
    // 实际的扩展因子
    int expansion_factor = 1 << log2_expansion_factor;
    // 新的子节点数量
    int num_new_children = num_children_ * expansion_factor;
    auto new_children = new(pointer_allocator().allocate(num_new_children))
        AlexNode<T, P> *[num_new_children];

    int cur = 0;
    // 遍历现有的子节点，并将每个子节点复制到新数组中相应的位置
    while (cur < num_children_) {
        AlexNode<T, P> *cur_child = children_[cur];
        // 复制的数量由当前子节点的duplication_factor_属性决定。
        int cur_child_repeats = 1 << cur_child->duplication_factor_;
        for (int i = expansion_factor * cur; i < expansion_factor * (cur + cur_child_repeats); i++) {
            new_children[i] = cur_child;
        }

        // 更新当前子节点的duplication_factor_属性，以便记录其被复制的次数。
        cur_child->duplication_factor_ += log2_expansion_factor;
        cur += cur_child_repeats;
    }
    pointer_allocator().deallocate(children_, num_children_);
    children_ = new_children;
    num_children_ = num_new_children;
    this->model_.expand(expansion_factor);
    return expansion_factor;
}
</code></pre>
<h5 id="AlexDataNode"><a href="#AlexDataNode" class="headerlink" title="AlexDataNode"></a>AlexDataNode</h5><p><strong>封装类型别名</strong>：</p>
<pre class=" language-lang-c++"><code class="language-lang-c++">template<class T, class P, class Compare = AlexCompare, class Alloc = std::allocator<std::pair<T, P>>, bool allow_duplicates = true>
class AlexDataNode : public AlexNode<T, P> {
    public:
        // 类型别名V, 表示键值对的类型
        typedef std::pair<T, P> V;
        // 类型别名self_type, 表示当前类的类型
        typedef AlexDataNode<T, P, Compare, Alloc, allow_duplicates> self_type;
        // 类型别名alloc_type, 表示用于分配self_type对象的分配器类型
        typedef typename Alloc::template rebind<self_type>::other alloc_type;
        // 类型别名key_alloc_type, 表示用于分配键类型的分配器类型
        typedef typename Alloc::template rebind<T>::other key_alloc_type;
        // 类型别名payload_alloc_type, 表示用于分配值类型的分配器类型
        typedef typename Alloc::template rebind<P>::other payload_alloc_type;
        // 类型别名value_alloc_type, 表示用于分配键值对类型的分配器类型
        typedef typename Alloc::template rebind<V>::other value_alloc_type;
        // 类型别名bitmap_alloc_type, 表示用于分配位图类型的分配器类型
        typedef typename Alloc::template rebind<uint64_t>::other bitmap_alloc_type;

        // 常量引用key_less_, 表示用于比较键大小的比较函数对象
        const Compare &key_less_;
        // 常量引用allocator_, 表示用于分配内存的分配器对象
        const Alloc &allocator_;

        // Forward declaration
        template<typename node_type = self_type, typename payload_return_type = P, typename value_return_type = V>
        class Iterator;    // 迭代容器中的元素

        // 类型别名iterator_type, 表示非const迭代器类型
        typedef Iterator<> iterator_type;
        // 类型别名const_iterator_type, 表示const迭代器类型
        typedef Iterator<const self_type, const P, const V> const_iterator_type;

        // 一个指向下一个叶子节点的指针next_leaf_, 初始值为nullptr
        self_type *next_leaf_ = nullptr;
        // 一个指向上一个叶子节点的指针prev_leaf_, 初始值为nullptr
        self_type *prev_leaf_ = nullptr;
};
</code></pre>
<p>数据节点属性：</p>
<pre class=" language-lang-c++"><code class="language-lang-c++">#if ALEX_DATA_NODE_SEP_ARRAYS
    T *key_slots_ = nullptr;        // holds keys
    P *payload_slots_ = nullptr;    // holds payloads, must be same size as key_slots
#else
    V* data_slots_ = nullptr;  // holds key-payload pairs
#endif
// 键/数据槽数组的大小
int data_capacity_ = 0;  // size of key/data_slots array
// 已填充的键/数据槽的数量（与间隙相对）
int num_keys_ = 0;  // number of filled key/data slots (as opposed to gaps)

// Bitmap: each uint64_t represents 64 positions in reverse order
// (i.e., each uint64_t is "read" from the right-most bit to the left-most bit)
// bitmap_是一个位图，每个uint64_t代表64个位置，从右到左读取
uint64_t *bitmap_ = nullptr;
// 位图中的int64_t数量
int bitmap_size_ = 0;  // number of int64_t in bitmap

// Variables related to resizing (expansions and contractions)
static constexpr double kMaxDensity_ = 0.8;  // density after contracting,
// also determines the expansion 
// threshold
static constexpr double kInitDensity_ = 0.7;  // density of data nodes after bulk loading
static constexpr double kMinDensity_ = 0.6;  // density after expanding, also
// determines the contraction 
// threshold
double expansion_threshold_ = 1;  // expand after m_num_keys is >= this number
double contraction_threshold_ = 0;  // contract after m_num_keys is < this number
static constexpr int kDefaultMaxDataNodeBytes_ = 1 << 24;  // by default, maximum data node size is 16MB
// 最大键/数据槽的数量，不能超过这个数量进行扩展
int max_slots_ = kDefaultMaxDataNodeBytes_ / sizeof(V);  // cannot expand beyond this number of key/data slots

// Counters used in cost models
long long num_shifts_ = 0;                 // does not reset after resizing
long long num_exp_search_iterations_ = 0;  // does not reset after resizing
int num_lookups_ = 0;                      // does not reset after resizing
int num_inserts_ = 0;                      // does not reset after resizing
int num_resizes_ = 0;  // technically not required, but nice to have

// Variables for determining append-mostly behavior
T max_key_ = std::numeric_limits<T>::lowest();  // max key in node, updates after inserts but not erases
T min_key_ = std::numeric_limits<T>::max();  // min key in node, updates after
// inserts but not erases
int num_right_out_of_bounds_inserts_ = 0;  // number of inserts that are larger than the max key
int num_left_out_of_bounds_inserts_ = 0;  // number of inserts that are smaller than the min key
// Node is considered append-mostly if the fraction of inserts that are out of
// bounds is above this threshold
// Append-mostly nodes will expand in a manner that anticipates further
// appends
static constexpr double kAppendMostlyThreshold = 0.9;

// Purely for benchmark debugging purposes
double expected_avg_exp_search_iterations_ = 0;
double expected_avg_shifts_ = 0;

// Placed at the end of the key/data slots if there are gaps after the max key
// 一个哨兵值，放置在键/数据槽的末尾，用于标记最大键之后的任何间隙
static constexpr T kEndSentinel_ = std::numeric_limits<T>::max();
</code></pre>
<p><strong>构造函数</strong>：</p>
<pre class=" language-lang-c++"><code class="language-lang-c++">```

**迭代器**：

```c++
</code></pre>
<p><strong>插入</strong>：</p>
<pre class=" language-lang-c++"><code class="language-lang-c++">

</code></pre>
<p><strong>查询</strong>：</p>
<p><code>c++</code></p>

                                    
                            </div>
                            <hr />

                            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">flyboy</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://flyboy716.github.io/posts/53ff.html">https://flyboy716.github.io/posts/53ff.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">flyboy</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



                                <div class="tag_share" style="display: block;">
                                    <div class="post-meta__tag-list" style="display: inline-block;">
                                        
                                            <div class="article-tag">
                                                
                                                    <a href="/tags/%E5%AD%A6%E4%B9%A0%E5%9E%8B%E7%B4%A2%E5%BC%95/">
                                                        <span class="chip bg-color">
                                                            学习型索引
                                                        </span>
                                                    </a>
                                                    
                                            </div>
                                            
                                    </div>
                                    <div class="post_share"
                                        style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                                        <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                                    </div>
                                </div>
                                
                                    <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

                                        
                        </div>
    </div>

    

                

                            

                                        

                                                    

                                                                

                                                                            

                                                                                        

                                                                                                    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/posts/36c1.html">
                    <div class="card-image">
                        
                        
                        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/medias/featureimages/9.jpg" class="responsive-img" alt="LearnedIndex">
                        
                        <span class="card-title">LearnedIndex</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2024-04-12
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E5%AD%A6%E4%B9%A0%E5%9E%8B%E7%B4%A2%E5%BC%95/" class="post-category">
                                    学习型索引
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E5%AD%A6%E4%B9%A0%E5%9E%8B%E7%B4%A2%E5%BC%95/">
                        <span class="chip bg-color">学习型索引</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/posts/323e.html">
                    <div class="card-image">
                        
                        
                        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/medias/featureimages/19.jpg" class="responsive-img" alt="FINEdex">
                        
                        <span class="card-title">FINEdex</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2024-04-12
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E5%AD%A6%E4%B9%A0%E5%9E%8B%E7%B4%A2%E5%BC%95/" class="post-category">
                                    学习型索引
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E5%AD%A6%E4%B9%A0%E5%9E%8B%E7%B4%A2%E5%BC%95/">
                        <span class="chip bg-color">学习型索引</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



        <!-- 代码块功能依赖 -->
        <script type="text/javascript"
            src="/libs/codeBlock/codeBlockFuction.js"></script>

        <!-- 代码语言 -->
        
            <script type="text/javascript"
                src="/libs/codeBlock/codeLang.js"></script>
            

                <!-- 代码块复制 -->
                
                    <script type="text/javascript"
                        src="/libs/codeBlock/codeCopy.js"></script>
                    

                        <!-- 代码块收缩 -->
                        
                            <script type="text/javascript"
                                src="/libs/codeBlock/codeShrink.js"></script>
                            


                                <style>
                                    .ititle {
                                        margin: 15px 0;
                                        text-align: center;
                                        font-family: 'Architects Daughter', cursive;
                                    }

                                    .ipage {
                                        line-height: 30px;
                                        margin: 0 auto;
                                        padding: 15px 32px 29px;
                                        background-color: #f9f9f9;
                                        box-shadow: 0px 2px 5px 0px rgba(0, 0, 0, 0.26);
                                        -moz-border-radius-bottomleft: 20px 500px;
                                        -moz-border-radius-bottomright: 500px 30px;
                                        -moz-border-radius-topright: 5px 100px;
                                        -webkit-border-bottom-left-radius: 20px 500px;
                                        -webkit-border-bottom-right-radius: 64px 10px;
                                        -webkit-border-top-right-radius: 5px 100px;
                                        border-bottom-left-radius: 20px 500px;
                                        border-bottom-right-radius: 64px 10px;
                                        border-top-right-radius: 5px 100px;
                                        -webkit-background-size: 100% 30px;
                                        -moz-box-shadow: 0 2px 10px 1px rgba(0, 0, 0, 0.2);
                                        -webkit-box-shadow: 0 2px 10px 1px rgba(0, 0, 0, 0.2);
                                        text-shadow: 0 1px 0 #F6EF97;
                                        position: relative;
                                    }

                                    .izhengwen {
                                        position: relative;
                                        top: 0;
                                        left: 0;
                                        z-index: 2;
                                        height: auto;
                                        background: repeating-linear-gradient(to bottom, #f9f9f9, #f9f9f9 31px, #6BA2D8 1px, #f9f9f9);
                                        background-size: 100% 32px;
                                    }

                                    #articleContent p {
                                        margin: 0
                                    }

                                    .ititle {
                                        font-family: 'Architects Daughter', cursive;
                                        font-size: 1.45rem !important;
                                        padding: 10px auto;
                                    }

                                    .izhengwen p {
                                        position: relative;
                                        line-height: 2.2rem !important;
                                        text-indent: 2em;
                                        font-family: 'Architects Daughter', cursive !important;
                                        font-size: 1.45rem !important;
                                    }

                                    .ipage::before {
                                        content: " ";
                                        display: inline-block;
                                        position: absolute;
                                        top: 0px;
                                        bottom: 0;
                                        right: 52px;
                                        z-index: 4;
                                        width: 4px;
                                        height: 100%;
                                        border-left: 1px solid #fca1a1;
                                    }

                                    .izhengwen p:nth-child(odd):before {
                                        content: " ";
                                        display: inline-block;
                                        position: absolute;
                                        top: 0;
                                        left: -16px;
                                        z-index: 3;
                                        width: 24px;
                                        height: 24px;
                                        background-color: #fff;
                                        -webkit-border-radius: 50%;
                                        -moz-border-radius: 50%;
                                        border-radius: 50%;
                                        box-shadow: inset 0px 2px 5px 0px rgba(0, 0, 0, 0.26);
                                    }

                                    .ipage:after {
                                        content: " ";
                                        display: inline-block;
                                        position: absolute;
                                        top: 0;
                                        bottom: 0;
                                        left: 52px;
                                        z-index: 3;
                                        width: 4px;
                                        height: 100%;
                                        border-left: 4px double #fca1a1;
                                    }

                                    .ipage p {
                                        padding: 0 2em;
                                        color: #333 !important;
                                    }

                                    body.dark .ipage {
                                        opacity: 0.85;
                                    }

                                    /*小屏幕下(手机类)的样式*/
                                    @media only screen and (max-width: 600px) {
                                        .ipage {
                                            padding: 15px 23px 29px;
                                        }

                                        .ipage:after {
                                            left: 36px;
                                        }

                                        .ipage::before {
                                            right: 36px;
                                        }

                                        .ipage p {
                                            padding: 0 0.9em;
                                        }
                                    }
                                </style>
    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>


<script src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$', '$'], ['\(', '\)']]}
    });
</script>



                            <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="tencent"
                   type="playlist"
                   id="1402317228"
                   fixed='true'
                   autoplay='true'
                   theme='#42b983'
                   loop='all'
                   order='list'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

            
                <div class="container row center-align"
                    style="margin-bottom: 15px !important;">

                    <!-- <div class="col fly0 fly1 s12 m3 l3 social-link" id="visitmap">
                        <a target="_blank" rel="noopener" href="https://clustrmaps.com/site/1bgb2" title="访客地图"><img
                                src="/medias/map-visit.png"></a>
                    </div> -->

                    <div class="col fly0 fly2 s12 m8 l8 copy-right">
                        Copyright&nbsp;&copy;
                        
                            <span id="year">
                                2021-2024
                            </span>
                            
                                    <span id="year">
                                        2021
                                    </span>
                                    <a href="/about" target="_blank">
                                        flyboy
                                            <br>
                                            
                                                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                                                    class="white-color">
                                                    49.5k
                                                </span>&nbsp;字
                                                
                                                    
                                                        
                                                            
                                                                
                                                                    
                                                                        <span id="busuanzi_container_site_pv">
                                                                            |&nbsp;<i
                                                                                class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span
                                                                                id="busuanzi_value_site_pv"
                                                                                class="white-color"></span>&nbsp;次
                                                                        </span>
                                                                        
                                                                            
                                                                                <span id="busuanzi_container_site_uv">
                                                                                    |&nbsp;<i
                                                                                        class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span
                                                                                        id="busuanzi_value_site_uv"
                                                                                        class="white-color"></span>&nbsp;人
                                                                                </span>
                                                                                
                                                                                    <br>
                                                                                    
                                                                                        <span
                                                                                            id="sitetime">载入运行时间...</span>
                                                                                        <script>
                                                                                            function siteTime() {
                                                                                                var seconds = 1000;
                                                                                                var minutes = seconds * 60;
                                                                                                var hours = minutes * 60;
                                                                                                var days = hours * 24;
                                                                                                var years = days * 365;
                                                                                                var today = new Date();
                                                                                                var startYear = "2021";
                                                                                                var startMonth = "2";
                                                                                                var startDate = "19";
                                                                                                var startHour = "11";
                                                                                                var startMinute = "20";
                                                                                                var startSecond = "0";
                                                                                                var todayYear = today.getFullYear();
                                                                                                var todayMonth = today.getMonth() + 1;
                                                                                                var todayDate = today.getDate();
                                                                                                var todayHour = today.getHours();
                                                                                                var todayMinute = today.getMinutes();
                                                                                                var todaySecond = today.getSeconds();
                                                                                                var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                                                                                                var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                                                                                                var diff = t2 - t1;
                                                                                                var diffYears = Math.floor(diff / years);
                                                                                                var diffDays = Math.floor((diff / days) - diffYears * 365);
                                                                                                var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                                                                                                var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                                                                                                    minutes);
                                                                                                var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                                                                                                    diffMinutes * minutes) / seconds);
                                                                                                if (startYear == todayYear) {
                                                                                                    document.getElementById("year").innerHTML = todayYear;
                                                                                                    document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffDays + " 天 " + diffHours +
                                                                                                        " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                                                                                                } else {
                                                                                                    document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                                                                                                    document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffYears + " 年 " + diffDays +
                                                                                                        " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                                                                                                }
                                                                                            }
                                                                                            setInterval(siteTime, 1000);
                                                                                        </script>
                                                                                        
                                                                                            <br>
                                                                                            
                    </div>
                    <div class="col fly0 fly3 s12 m4 l4 social-statis social-link social-statis">
                        
    <a href="https://github.com/flyboy716" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:3144214492@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=3144214492" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 3144214492" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>


                    </div>
                </div>
                </div>
</footer>

<div class="progress-bar"></div>

                                <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

                                    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


                                        <script type="text/javascript">
                                            var OriginTitile = document.title, st;
                                            document.addEventListener("visibilitychange", function () {
                                                document.hidden ? (document.title = "ヽ(●-`Д´-)ノ你要玩捉迷藏嘛", clearTimeout(st)) : (document.title = "(Ő∀Ő3)ノ我看见你了！", st = setTimeout(function () { document.title = OriginTitile }, 3e3))
                                            })
                                        </script>

                                        <script src="/js/cursor.js"></script>
                                        <script src="/js/click_show_text.js"></script>

                                        <!--动态线条背景-->
                                        <script type="text/javascript" color="122 103 238" opacity='0.7' zIndex="-2"
                                            count="200" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js">
                                            </script>


                                        <canvas class="fireworks"
                                            style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;"></canvas>
                                        <script type="text/javascript"
                                            src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script>
                                        <script type="text/javascript" src="/js/fireworks.js"></script>

                                        <script type="text/javascript">
                                            //只在桌面版网页启用特效
                                            var windowWidth = $(window).width();
                                            if (windowWidth > 768) {
                                                document.write('<script type="text/javascript" src="/js/sakura.js"><\/script>');
                                            }
                                        </script>
                                        <script
                                            src="/libs/materialize/materialize.min.js"></script>
                                        <script
                                            src="/libs/masonry/masonry.pkgd.min.js"></script>
                                        <script
                                            src="/libs/aos/aos.js"></script>
                                        <script
                                            src="/libs/scrollprogress/scrollProgress.min.js"></script>
                                        <script
                                            src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
                                        <script
                                            src="/js/matery.js"></script>

                                        <!-- Baidu Analytics -->

                                            <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

                                                
                                                    <script
                                                        src="/libs/others/clicklove.js"
                                                        async="async"></script>
                                                    
                                                        
                                                            <script async
                                                                src="/libs/others/busuanzi.pure.mini.js"></script>
                                                            

                                                                

                                                                        

                                                                                <!--腾讯兔小巢-->
                                                                                
                                                                                        
                                                                                            <script
                                                                                                type="text/javascript"
                                                                                                color="0,0,255"
                                                                                                pointColor="0,0,255"
                                                                                                opacity='0.7'
                                                                                                zIndex="-1"
                                                                                                count="99"
                                                                                                src="/libs/background/canvas-nest.js"></script>
                                                                                            

                                                                                                
                                                                                                    
                                                                                                        <script
                                                                                                            type="text/javascript"
                                                                                                            size="150"
                                                                                                            alpha='0.6'
                                                                                                            zIndex="-1"
                                                                                                            src="/libs/background/ribbon-refresh.min.js"
                                                                                                            async="async"></script>
                                                                                                        

                                                                                                            
                                                                                                                <script
                                                                                                                    type="text/javascript"
                                                                                                                    src="/libs/background/ribbon-dynamic.js"
                                                                                                                    async="async"></script>
                                                                                                                

                                                                                                                    
                                                                                                                        <script
                                                                                                                            src="/libs/instantpage/instantpage.js"
                                                                                                                            type="module"></script>
                                                                                                                        

                                                                                                                            <div
                                                                                                                                id="weather-v2-plugin-simple">
                                                                                                                            </div>
                                                                                                                            <script>
                                                                                                                                WIDGET = {
                                                                                                                                    CONFIG: {
                                                                                                                                        "modules": "01234",
                                                                                                                                        "background": 1,
                                                                                                                                        "tmpColor": "FA1010",
                                                                                                                                        "tmpSize": 16,
                                                                                                                                        "cityColor": "DD1111",
                                                                                                                                        "citySize": 16,
                                                                                                                                        "aqiSize": 16,
                                                                                                                                        "weatherIconSize": 24,
                                                                                                                                        "alertIconSize": 18,
                                                                                                                                        "padding": "10px 10px 10px 10px",
                                                                                                                                        "shadow": "1",
                                                                                                                                        "language": "zh",
                                                                                                                                        "borderRadius": 5,
                                                                                                                                        "fixed": "false",
                                                                                                                                        "vertical": "middle",
                                                                                                                                        "horizontal": "left",
                                                                                                                                        "key": "t0heAtUUdO"
                                                                                                                                    }
                                                                                                                                }
                                                                                                                            </script>
                                                                                                                            <script
                                                                                                                                src="https://apip.weatherdt.com/simple/static/js/weather-simple-common.js?v=2.0"></script>








                
        <script src="//cdn.jsdelivr.net/npm/js-base64/base64.min.js"></script>
        <script>
        const hasAttr = (e,a) => a.some(_=> e.attr(_)!==undefined);
        $('a').each(function() {
          const $this = $(this);
          if(hasAttr($this,["data-fancybox","ignore-external-link"])) return;
          const href = $this.attr('href');
          if (href && href.match('^((http|https|thunder|qqdl|ed2k|Flashget|qbrowser|ftp|rtsp|mms)://)')) {
            const strs = href.split('/');
            if (strs.length >= 3) {
                const host = strs[2];
                if (host !== 'your_domain' || window.location.host) {
                    $this.attr('href', '/go.html?u='+Base64.encode(href)+'').attr('rel', 'external nofollow noopener noreferrer');
                    if (true) {
                        $this.attr('target', '_blank');
                    }
                }
            }
          }
        });
        </script><script>
            window.imageLazyLoadSetting = {
                isSPA: true,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(n){n.imageLazyLoadSetting.processImages=i;var e=n.imageLazyLoadSetting.isSPA,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function i(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight||document.documentElement.clientHeight)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e&&e()},n.src=i}()}i(),n.addEventListener("scroll",function(){var t,e;t=i,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this);</script></body>

</html>